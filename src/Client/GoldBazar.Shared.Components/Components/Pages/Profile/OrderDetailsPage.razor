@page "/profile/order-history/{orderId:int}"
@rendermode InteractiveServer
@inject OrderingService _orderingService
@inject IJSRuntime JSRuntime
@using GoldBazar.Client.Web.Components.Pages.Profile.Components;

<PageTitle>GOLD BAZAR - Order Details</PageTitle>

@if (order == null)
{
    return;
}

<main class="bg-[#f6f6f6] flex flex-col h-dvh overflow-x-hidden overflow-y-auto scroll-smooth">
    <div class="p-[24px] mx-2">
        <div class="flex justify-between items-center">
            <h2 class="text-[20px] text-[#1A1A1A]">داواکارییەکەم</h2>
            <button class="cursor-pointer bg-white p-2 rounded-xl" @onclick="GoBack">
                <ArrowLeft Stroke="currentColor" />
            </button>
        </div>

        <div class="mt-6 bg-white p-4 rounded-xl flex items-start justify-between">
            <div class="flex flex-col text-[#666666]">
                <h2 class="text-[18px]">مستیلە</h2>
                <span class="mt-4 text-sm">٢٠٢٤/٠٣/١٥</span>
            </div>
            <div class="py-2 px-4 rounded-full text-sm font-bold bg-[#FFF7ED] text-[#9A3412]">
                لای گەیەنەرە
            </div>
        </div>

        <div class="mt-6 bg-white p-4 rounded-xl flex flex-col gap-4">
            <NavLink href="/products/1" class="flex gap-4">
                <div class="overflow-hidden flex size-[80px] items-center justify-center rounded-lg bg-white">
                    <img class="object-cover"
                        src="https://goldbazarblob.blob.core.windows.net/development/items/item27.jpg" />
                </div>
                <div class="flex flex-col gap-1.5">
                    <h3 class="text-black text-base">گوارەی عەیارە 21</h3>
                    <h4 class="text-sm text-[#666666]">زەڕەنگەری تۆانا</h4>
                    <div class="flex gap-4">
                        @* @if (product.Discount > 0)
                        { *@
                        <span class="text-sm text-[#070707]">189</span>
                        <span class="text-sm text-[#898989] line-through">199</span>
                        @* }
                        else
                        {
                        <span class="text-sm text-[#070707]">189</span>
                        } *@
                    </div>
                </div>
            </NavLink>

            <NavLink href="/products/1" class="flex gap-4">
                <div class="overflow-hidden flex size-[80px] items-center justify-center rounded-lg bg-white">
                    <img class="object-cover"
                        src="https://goldbazarblob.blob.core.windows.net/development/items/item27.jpg" />
                </div>
                <div class="flex flex-col gap-1.5">
                    <h3 class="text-black text-base">گوارەی عەیارە 21</h3>
                    <h4 class="text-sm text-[#666666]">زەڕەنگەری تۆانا</h4>
                    <div class="flex gap-4">
                        @* @if (product.Discount > 0)
                        { *@
                        <span class="text-sm text-[#070707]">189</span>
                        <span class="text-sm text-[#898989] line-through">199</span>
                        @* }
                        else
                        {
                        <span class="text-sm text-[#070707]">189</span>
                        } *@
                    </div>
                </div>
            </NavLink>
        </div>

        <div class="mt-6 bg-white p-4 rounded-xl flex flex-col">
            <h2 class="text-base text-[#1A1A1A]">زانیاری گەیاندن</h2>
            <div class="mt-4 flex flex-col gap-4">
                <div class="flex gap-2">
                    <LocationIcon Height="20" Width="20" Stroke="#666666" />
                    <div class="flex flex-col gap-1.5">
                        <span class="text-[#666666] text-sm">ناونیشان</span>
                        <span class="text-sm text-[#1A1A1A]">سلێمانی، چەمچەماڵ، گەڕەکی شەهیدان</span>
                    </div>
                </div>
                <div class="flex gap-2">
                    <NoticeIcon Height="20" Width="20" Stroke="#666666" />
                    <div class="flex flex-col gap-1.5">
                        <span class="text-[#666666] text-sm">تێبینی</span>
                        <span class="text-sm text-[#1A1A1A]">تکایە پەیوەندیم پێوە بکە پێش گەیاندن</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-6 bg-white p-4 rounded-xl flex flex-col">
            <h2 class="text-base text-[#1A1A1A]">کۆی گشتی</h2>
            <div class="mt-4 flex flex-col gap-4">
                <ul class="flex flex-col gap-3 text-sm text-[#666666]">
                    <li class="flex items-center justify-between">
                        <span>نرخی بەرهەم</span>
                        <span>189</span>
                    </li>
                    <li class="flex items-center justify-between">
                        <span>داشکاندن</span>
                        <span>١٠</span>
                    </li>
                </ul>
                <div class="flex items-center justify-between text-[#1A1A1A] border-t border-[#E0E0E0] pt-4">
                    <span>کۆی گشتی</span>
                    <span>١٧٩</span>
                </div>
            </div>
        </div>
    </div>
</main>

@code {
    [Parameter]
    public int orderId { get; set; }

    private GoldBazar.Shared.Components.Services.OrderDto order { get; set; } = default!;

    private async Task GoBack()
    {
        await JSRuntime.InvokeVoidAsync("history.back");
    }

    protected override async Task OnInitializedAsync()
    {
        try
        {
            order = await _orderingService.GetOrders(orderId);
        }
        catch
        {
            @* TODO: In all fetch data from server we need to handle error like not found and ... *@
        }
    }
}